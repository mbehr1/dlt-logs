"use strict";(self.webpackChunkdlt_logs=self.webpackChunkdlt_logs||[]).push([[979],{7425:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>u,toc:()=>d});var r=t(4848),i=t(8453),a=t(1470),l=t(9365);const o={id:"rewritePlugin",title:"rewrite plugin",sidebar_label:"Plugin Rewrite"},s=void 0,u={id:"rewritePlugin",title:"rewrite plugin",description:'DLT-Logs extension version >= 1.19.0 come with a plugin that supports "rewriting"/modification of messages.',source:"@site/docs/rewritePlugin.md",sourceDirName:".",slug:"/rewritePlugin",permalink:"/dlt-logs/docs/rewritePlugin",draft:!1,unlisted:!1,editUrl:"https://github.com/mbehr1/dlt-logs/edit/master/docs/dlt-logs/docs/rewritePlugin.md",tags:[],version:"current",frontMatter:{id:"rewritePlugin",title:"rewrite plugin",sidebar_label:"Plugin Rewrite"},sidebar:"dltLogsSideBar",previous:{title:"Plugin Non-verbose mode",permalink:"/dlt-logs/docs/nonVerbosePlugin"}},c={},d=[{value:"Example",id:"example",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Treeview",id:"treeview",level:2},{value:"Limitations",id:"limitations",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:'DLT-Logs extension version >= 1.19.0 come with a plugin that supports "rewriting"/modification of messages.'}),"\n",(0,r.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,r.jsx)(n.p,{children:"The example configuration below shows one intended use-case:\nOften e.g. SysLog based messages are piped into DLT. But as typically there are additional latencies the timestamp from the DLT message is the timestamp where the process piping the data into DLT was executed and not from when the original message was created.\nE.g."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"...\n14043 5:43:24 PM  6.4859 ECU1 SYS  JOUR info 2020/03/24 17:18:19.118891 0.000000 kernel: Informational: Booting Linux on physical CPU 0x0\n...\n14188 5:43:24 PM  6.4897 ECU1 SYS  JOUR info 2020/03/24 17:18:19.121146 0.002251 kernel: Informational: Console: colour dummy device 80x25\n...\n"})}),"\n",(0,r.jsx)(n.p,{children:"using the config below this can be changed to:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"...\n14043 5:43:24 PM  0.0000 ECU1 SYS  JOUR info kernel: Informational: Booting Linux on physical CPU 0x0\n...\n14188 5:43:24 PM  0.0023 ECU1 SYS  JOUR info kernel: Informational: Console: colour dummy device 80x25\n...\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["See here that the timestamp is now correctly set to 0 and 2.3ms as taken from the syslog time and not at 6.4s which is the time when the dlt-syslog-pipe process dumped it into DLT.\nThis makes the ",(0,r.jsx)(n.a,{href:"toggleSortOrder",children:"toggle sort order"}),"! feature where DLT logs get sorted by timestamp really useful!"]})}),"\n",(0,r.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsx)(n.p,{children:"You have to configure the 'rewrite' plugin. To configure the plugin call"}),"\n",(0,r.jsxs)(a.A,{groupId:"operating-systems",defaultValue:"win",values:[{label:"Windows",value:"win"},{label:"macOS",value:"mac"},{label:"Linux",value:"linux"}],children:[(0,r.jsx)(l.A,{value:"win",children:'Use F1 or Ctrl+Shift+P and enter/select command "Preferences: Open Settings (JSON)".'}),(0,r.jsx)(l.A,{value:"mac",children:'Use \u21e7\u2318P and enter/select command "Preferences: Open Settings (JSON)".'}),(0,r.jsx)(l.A,{value:"linux",children:'Use Ctrl+Shift+P and enter/select command "Preferences: Open Settings (JSON)".'})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jsonc",children:'"dlt-logs.plugins": [\n        ...\n        {\n            "name":"NonVerbose",\n            ...\n        },{\n            "name": "Rewrite", // config for \'rewrite\' plugin\n            "enabled":true, // default to true, set to `false`to disable\n            "rewrites":[ // array with rewrite-configs\n                {\n                    "name":"SYS/JOUR timestamp", // name of the rewrite-config\n                    "filter":{ // filter settings applied. Same as filter config.\n                        "apid":"SYS",\n                        "ctid":"JOUR"\n                    },\n                    "payloadRegex":"^.*? .*? (?<timeStamp>\\\\d+\\\\.\\\\d+) (?<text>.*)$", // regex applied on the payload. Rewrites are done based on two possible capture group names: \n                    // The captured value from group `text` will be used as the new text for the message.\n                    // The value from group `timeStamp` is expected to be in seconds and will be used for the new timestamp of the message (so internally multiplied by 10000 to be in 0.1ms).\n                }\n            ]\n        },\n    ],\n'})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["If you changed the config you do need to open a new file or use ",(0,r.jsx)(n.code,{children:"Developer: Reload window"})," to reload the window incl. the extension host."]})}),"\n",(0,r.jsx)(n.h2,{id:"treeview",children:"Treeview"}),"\n",(0,r.jsx)(n.p,{children:"In the tree-view you'll find more information about the loaded service and methods under"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Plugins\n|- 'Rewrite' plugin\n   |- Rewrites (<number of rewrite configs loadedloaded>)\n      | - <list of all loaded rewrite configs with name>\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"The tooltip of each rewrite config contains more info e.g. the filter settings and which fields will be rewritten/modified."})}),"\n",(0,r.jsx)(n.p,{children:"(todo add picture)"}),"\n",(0,r.jsx)(n.h2,{id:"limitations",children:"Limitations"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The plugin is not applied on exporting DLT logs. Only on viewing."}),"\n",(0,r.jsx)(n.li,{children:"Rewrite functions are only supported with the deprecated NodeJS based parser. So removed the documentation from here. If you have use-cases for it please raise an issue in github!"}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},9365:(e,n,t)=>{t.d(n,{A:()=>l});t(6540);var r=t(4164);const i={tabItem:"tabItem_Ymn6"};var a=t(4848);function l(e){let{children:n,hidden:t,className:l}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,r.A)(i.tabItem,l),hidden:t,children:n})}},1470:(e,n,t)=>{t.d(n,{A:()=>j});var r=t(6540),i=t(4164),a=t(3104),l=t(6347),o=t(205),s=t(7485),u=t(1682),c=t(9466);function d(e){var n,t;return null!=(n=null==(t=r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:t.filter(Boolean))?n:[]}function h(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=null!=n?n:function(e){return d(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:i}}=e;return{value:n,label:t,attributes:r,default:i}}))}(t);return function(e){const n=(0,u.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error('Docusaurus error: Duplicate values "'+n.map((e=>e.value)).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[n,t])}function p(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:t}=e;const i=(0,l.W6)(),a=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=t?t:null}({queryString:n,groupId:t});return[(0,s.aZ)(a),(0,r.useCallback)((e=>{if(!a)return;const n=new URLSearchParams(i.location.search);n.set(a,e),i.replace({...i.location,search:n.toString()})}),[a,i])]}function f(e){const{defaultValue:n,queryString:t=!1,groupId:i}=e,a=h(e),[l,s]=(0,r.useState)((()=>function(e){var n;let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:r}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+t+'" but none of its children has the corresponding value. Available values are: '+r.map((e=>e.value)).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return t}const i=null!=(n=r.find((e=>e.default)))?n:r[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:n,tabValues:a}))),[u,d]=m({queryString:t,groupId:i}),[f,g]=function(e){let{groupId:n}=e;const t=function(e){return e?"docusaurus.tab."+e:null}(n),[i,a]=(0,c.Dv)(t);return[i,(0,r.useCallback)((e=>{t&&a.set(e)}),[t,a])]}({groupId:i}),b=(()=>{const e=null!=u?u:f;return p({value:e,tabValues:a})?e:null})();(0,o.A)((()=>{b&&s(b)}),[b]);return{selectedValue:l,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:a}))throw new Error("Can't select invalid tab value="+e);s(e),d(e),g(e)}),[d,g,a]),tabValues:a}}var g=t(2303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var v=t(4848);function w(e){let{className:n,block:t,selectedValue:r,selectValue:l,tabValues:o}=e;const s=[],{blockElementScrollPositionUntilNextRender:u}=(0,a.a_)(),c=e=>{const n=e.currentTarget,t=s.indexOf(n),i=o[t].value;i!==r&&(u(n),l(i))},d=e=>{var n;let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{var r;const n=s.indexOf(e.currentTarget)+1;t=null!=(r=s[n])?r:s[0];break}case"ArrowLeft":{var i;const n=s.indexOf(e.currentTarget)-1;t=null!=(i=s[n])?i:s[s.length-1];break}}null==(n=t)||n.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":t},n),children:o.map((e=>{let{value:n,label:t,attributes:a}=e;return(0,v.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>s.push(e),onKeyDown:d,onClick:c,...a,className:(0,i.A)("tabs__item",b.tabItem,null==a?void 0:a.className,{"tabs__item--active":r===n}),children:null!=t?t:n},n)}))})}function x(e){let{lazy:n,children:t,selectedValue:i}=e;const a=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=a.find((e=>e.props.value===i));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:a.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==i})))})}function y(e){const n=f(e);return(0,v.jsxs)("div",{className:(0,i.A)("tabs-container",b.tabList),children:[(0,v.jsx)(w,{...e,...n}),(0,v.jsx)(x,{...e,...n})]})}function j(e){const n=(0,g.A)();return(0,v.jsx)(y,{...e,children:d(e.children)},String(n))}},8453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>o});var r=t(6540);const i={},a=r.createContext(i);function l(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);